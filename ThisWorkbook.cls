VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "ThisWorkbook"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True

' Excel 文n打_r的操作
Private Sub Workbook_Open()

    On Error Resume Next

    ''遍v所有模K，K移除不符合l件的已存在模K
    'Dim moduleName
    'moduleName = Array("clsBrowser", "clsCore", "clsJsConverter", "DatabaseDispatchModule", "DatabaseControlPanel", "DatabaseModule")
    'Dim i As Integer, j As Integer
    'Dim flagBoolean As Boolean
    'flagBoolean = True
    'For i = 1 To ThisWorkbook.VBProject.VBComponents.Count
    '    flagBoolean = True
    '    For j = LBound(moduleName) To UBound(moduleName)
    '        If CStr(ThisWorkbook.VBProject.VBComponents(i).Name) = moduleName(j) Then
    '            flagBoolean = False
    '            Exit For
    '        End If
    '    Next j
    '    If (CStr(ThisWorkbook.VBProject.VBComponents(i).Name) = "ThisWorkbook") Then
    '        flagBoolean = False
    '    End If
    '    For j = 1 To ThisWorkbook.Worksheets.Count
    '        If CStr(ThisWorkbook.VBProject.VBComponents(i).Name) = CStr(ThisWorkbook.Worksheets(j).Name) Then
    '            flagBoolean = False
    '            Exit For
    '        End If
    '    Next j
    '    If flagBoolean Then
    '        'Debug.Print ThisWorkbook.VBProject.VBComponents(i).Name
    '        ThisWorkbook.VBProject.VBComponents.Remove ThisWorkbook.VBProject.VBComponents(i): Rem 移除模K
    '    End If
    'Next i

    'ThisWorkbook.Save

    Call DatabaseDispatchModule.initial  '{用接操控煺{度模M的自定x子^程量初始化x初值
    Call DatabaseDispatchModule.MenuSetup  '{用接操控煺{度模M的自定x子^程建自定x菜

End Sub


' Excel 文nP]前的操作
Private Sub Workbook_BeforeClose(Cancel As Boolean)

    On Error Resume Next

    'Call DatabaseDispatchModule.callRemoveModule  '{用接操控煺{度模M的自定x子^程移除清理程序自入的模K
    ''Call DatabaseDispatchModule.callKillProcess  '{用接操控煺{度模M的自定x子^程P]清理程序自建的M程

    'ThisWorkbook.Save

End Sub


''入指定的模K文n，K自定x重命名入的模K
'Public Sub importModule(moduleFile As String, moduleName As String)
'
'    On Error Resume Next

'    ''自定x的待入的y算法模K
'    'Dim moduleName As String, modulePath As String, moduleFileName As String, moduleFile As String
'    'moduleName = "KLineChart"  '接操控 MongoDB 炷K的自定x命名
'    'modulePath = "C:\Criss\vba\QualityControl\KLineChart"  '接操控 MongoDB 炷K的保存路
'    'moduleFileName = "KLineChart.bas"  '接操控 MongoDB 炷K的文n名
'    'moduleFile = modulePath & "\" & moduleFileName  '接操控 MongoDB 炷K文n的路饺名

'    '判嘧远x的y算法模K是否保存在指定的路
'    Dim FSO As Object
'    Set FSO = CreateObject("Scripting.FileSystemObject")
'    'If fso.Folderexists(modulePath) And fso.Fileexists(moduleFile) Then
'    If FSO.FileExists(moduleFile) Then

'        '使用 Is Nothing 方法判嘀付名字的模K是否已存在，注意需要上Z句 On Error Resume Next，不然]有找到指定的模Kr箦e
'        If ThisWorkbook.VBProject.VBComponents(moduleName) Is Nothing Then

'            '挠脖P文n入模K
'            With ThisWorkbook.VBProject.VBComponents.Import(moduleFile)
'                .name = moduleName  '入的模K自定x重命名
'            End With

'        Else

'            '首先移除指定模K moduleName
'            ThisWorkbook.VBProject.VBComponents.Remove ThisWorkbook.VBProject.VBComponents(moduleName)  '移除指定模K moduleName
'            'С鲋付模K moduleName 至指定文n moduleFile
'            'ThisWorkbook.VBProject.VBComponents(moduleName).Export moduleFile
'            '模K重命名
'            'ThisWorkbook.VBProject.VBComponents("A").Name = "B"

'            '然後再次使用 Is Nothing 方法判嘀付名字的模K是否已存在，注意需要上Z句 On Error Resume Next，不然]有找到指定的模Kr箦e
'            If ThisWorkbook.VBProject.VBComponents(moduleName) Is Nothing Then

'                '挠脖P文n入模K
'                With ThisWorkbook.VBProject.VBComponents.Import(moduleFile)
'                    .name = moduleName  '入的模K自定x重命名
'                End With

'            Else

'                Debug.Print "imported Module ( " & moduleName & " ) error, Module ( " & moduleName & " ) already exists, and unable to remove update."
'                'Exit Sub

'            End If

'        End If

'        'Debug.Print "import Module ( " & moduleName & " ) source file: " & moduleFile

'    Else

'        Debug.Print "import Module ( " & moduleName & " ) error, Source file ( " & moduleFile & " ) is Nothing."

'    End If

'    Set FSO = Nothing

'End Sub


''移除指定的已存在模K
'Public Sub removeModule(moduleName As String)

'    On Error Resume Next

'    '使用 Is Nothing 方法判嘀付名字的模K是否已存在，注意需要上Z句 On Error Resume Next，不然]有找到指定的模Kr箦e
'    If ThisWorkbook.VBProject.VBComponents(moduleName) Is Nothing Then

'        Debug.Print "Module ( " & moduleName & " ) is Nothing."

'    Else

'        ThisWorkbook.VBProject.VBComponents.Remove ThisWorkbook.VBProject.VBComponents(moduleName)  '移除模K

'        '模K移除之後，再次使用 Is Nothing 方法判嘀付名字的模K是否已存在，注意需要上Z句 On Error Resume Next，不然]有找到指定的模Kr箦e
'        If ThisWorkbook.VBProject.VBComponents(moduleName) Is Nothing Then

'            'Debug.Print "Module ( " & moduleName & " ) be removed."

'        Else

'            Debug.Print "remove Module ( " & moduleName & " ) error, Module ( " & moduleName & " ) cannot be remove."
'            'Exit Sub

'        End If

'    End If

'End Sub

